# Threat Event (Unauthorized Firefox Usage)
**Unauthorized Firefox Browser Installation and Use**
## Steps the "Bad Actor" took to Create Logs and IoCs:

1. Download the Firefox installer from Mozilla:  
   https://download.mozilla.org/?product=firefox-latest-ssl&os=win64&lang=en-US  

2. Install it silently:  
   ```"Firefox Setup 142.0.exe" /S```  

3. Launch Firefox from the installation directory:  
   ```C:\Program Files\Mozilla Firefox\firefox.exe```  

4. Connect to the internet and browse a few safe sites to generate logs:  
   - https://www.wikipedia.org/  
   - https://www.bing.com/  

5. Create a file on the desktop simulating data staging:  
   `project-data.txt`  

6. Create another file simulating bookmark export:  
   `firefox-exported-bookmarks.html`  

7. Optionally, delete the files (in this lab, only creation events were observed).  

## Tables Used to Detect IoCs:

| **Parameter**       | **Description**                                                                 |
|----------------------|---------------------------------------------------------------------------------|
| **Name** | DeviceFileEvents |  
| **Info** | https://learn.microsoft.com/en-us/defender-xdr/advanced-hunting-devicefileevents-table |  
| **Purpose** | Used to detect Firefox installer download and file creation activity (e.g., `project-data.txt`, `firefox-exported-bookmarks.html`). |  

| **Name** | DeviceProcessEvents |  
| **Info** | https://learn.microsoft.com/en-us/defender-xdr/advanced-hunting-deviceprocessevents-table |  
| **Purpose** | Used to detect silent installation of Firefox and subsequent `firefox.exe` launches. |  

| **Name** | DeviceNetworkEvents |  
| **Info** | https://learn.microsoft.com/en-us/defender-xdr/advanced-hunting-devicenetworkevents-table |  
| **Purpose** | Used to detect outbound network activity generated by `firefox.exe` (HTTPS sessions to external sites). |  

## Related Queries

```kql
// Detect Firefox installer being downloaded
DeviceFileEvents
| where FileName startswith "Firefox Setup"

// Firefox being silently installed
DeviceProcessEvents
| where ProcessCommandLine has_all ("Firefox Setup", "/S")
| project Timestamp, DeviceName, ActionType, FileName, ProcessCommandLine

// Firefox executable written to disk
DeviceFileEvents
| where FileName == "firefox.exe"
| project Timestamp, DeviceName, RequestAccountName, ActionType, InitiatingProcessCommandLine

// Firefox process launched
DeviceProcessEvents
| where FileName == "firefox.exe"
| project Timestamp, DeviceName, AccountName, ActionType, ProcessCommandLine

// Firefox making outbound network connections
DeviceNetworkEvents
| where InitiatingProcessFileName == "firefox.exe"
| project Timestamp, DeviceName, InitiatingProcessAccountName, InitiatingProcessFileName, RemoteIP, RemotePort, RemoteUrl
| order by Timestamp desc

// User created files on Desktop (data staging simulation)
DeviceFileEvents
| where FileName in ("project-data.txt","firefox-exported-bookmarks.html")
```
## Created By:
- **Author Name**: Daniel Botomogno
- **Author Contact**: https://www.linkedin.com/in/daniel-botomogno-fsri-flmi-35992588/ 
- **Date**: August 25, 2025  

## Validated By:
- **Reviewer Name**:   
- **Reviewer Contact**:   
- **Validation Date**:   


## Additional Notes:
- File deletion events were expected but were not observed during the lab execution.  
- Network activity confirmed that Firefox successfully generated HTTPS traffic.  
- This lab demonstrates how even non-administrative users can install and use unauthorized browsers, bypassing policy restrictions.  

## Revision History:

| **Version** | **Changes**                  | **Date**          | **Modified By**     |
|-------------|------------------------------|-------------------|---------------------|
| 1.0         | Initial Firefox draft report | August 25, 2025   | Daniel Botomogno    |


